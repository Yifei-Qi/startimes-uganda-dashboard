const colorMap = {
  'Offline · Visual': '#22c55e',
  'Offline · Audio': '#0ea5e9',
  'Offline · Audio + Visual': '#f97316',
  'Online · Visual': '#38bdf8',
  'Online · Audio + Visual': '#e11d48'
};

const option = {
  backgroundColor: 'transparent',
  grid: {
    left: '12%',
    right: '12%',
    top: '8%',
    bottom: '18%'
  },
  tooltip: {
    trigger: 'item',
    backgroundColor: 'rgba(15,23,42,0.95)',
    borderColor: 'rgba(148,163,184,0.6)',
    borderWidth: 1,
    padding: 10,
    textStyle: {
      fontFamily: 'Barlow',
      fontSize: 11,
      color: '#e5e7eb'
    },
    formatter: function (params) {
      const d = params.data;
      return [
        '<strong>' + d.name + '</strong>',
        '<br/>Segment: ' + d.category,
        '<br/>' + d.note
      ].join('');
    }
  },
  xAxis: {
    type: 'value',
    min: -1,
    max: 1,
    splitLine: { show: false },
    axisTick: { show: false },
    axisLine: {
      show: true,
      onZero: true,
      lineStyle: {
        color: 'rgba(148,163,184,0.7)',
        width: 1.2
      },
      // 双向箭头
      symbol: ['arrow', 'arrow'],
      symbolSize: [10, 12]
    },
    axisLabel: {
      color: 'rgba(148,163,184,0.9)',
      fontFamily: 'Barlow Condensed',
      fontSize: 11,
      margin: 22,
      formatter: function (val) {
        if (val === -1) return 'OFFLINE';
        if (val === 1) return 'ONLINE';
        return '';
      }
    }
  },
  yAxis: {
    type: 'value',
    min: -1,
    max: 1,
    splitLine: { show: false },
    axisTick: { show: false },
    axisLine: {
      show: true,
      onZero: true,
      lineStyle: {
        color: 'rgba(148,163,184,0.7)',
        width: 1.2
      },
      // 双向箭头
      symbol: ['arrow', 'arrow'],
      symbolSize: [10, 12]
    },
    axisLabel: {
      color: 'rgba(148,163,184,0.9)',
      fontFamily: 'Barlow Condensed',
      fontSize: 11,
      margin: 18,
      formatter: function (val) {
        if (val === -1) return 'VISUAL';
        if (val === 1) return 'AUDIO';
        return '';
      }
    }
  },
  series: [
    {
      type: 'scatter',
      symbol: 'circle',
      data: touchpoints.map(tp => ({
        value: [tp.x, tp.y],
        name: tp.name,
        category: tp.category,
        note: tp.note,
        itemStyle: {
          color: colorMap[tp.category] || '#38bdf8',
          shadowBlur: 16,
          shadowColor: (colorMap[tp.category] || '#38bdf8') + 'dd'
        },
        symbolSize:
          tp.category.indexOf('Audio + Visual') !== -1 ? 18 : 14
      })),
      emphasis: {
        scale: 1.35
      },
      label: {
        show: true,
        position: 'right',
        formatter: '{b}',
        color: '#e5e7eb',
        fontFamily: 'Barlow Condensed',
        fontSize: 11
      }
    }
  ]
};

chart.setOption(option);
