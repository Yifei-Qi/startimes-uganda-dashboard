<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Solar · Off-Grid Power · StarTimes Uganda</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- 字体（与 DVB 页一致的 Barlow / Mono） -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;500;600;700&family=Barlow:wght@300;400;500;600&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #020617;
      --glass-bg: rgba(15, 23, 42, 0.78);
      --glass-border: rgba(148, 163, 184, 0.55);
      --glass-shadow: 0 22px 60px rgba(15, 23, 42, 0.95);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;

      --c-solar: #22c55e;
      --c-middle: #a855f7;
      --c-outer: #38bdf8;

      --font-main: "Barlow", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      --font-cond: "Barlow Condensed", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      --font-mono: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      height: 100vh;
      width: 100vw;
      overflow: hidden;
      background: radial-gradient(circle at 20% 10%, #0f172a 0, transparent 55%),
                  radial-gradient(circle at 80% 85%, #111827 0, transparent 55%),
                  radial-gradient(circle at 60% 25%, #020617 0, #020617 100%);
      color: var(--text-main);
      font-family: var(--font-main);
    }

    /* 顶部导航（与 ecology-dvb.html 对齐） */
    .top-bar {
      position: fixed;
      inset: 0 0 auto 0;
      height: 72px;
      padding: 16px 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 20;
      background: linear-gradient(to bottom, rgba(2,6,23,0.96), rgba(2,6,23,0.75), transparent);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(15,23,42,0.9);
      pointer-events: none;
    }

    .top-left {
      pointer-events: auto;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .top-path {
      font-family: var(--font-cond);
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #64748b;
    }

    .top-title {
      font-family: var(--font-cond);
      font-size: 22px;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: #f9fafb;
      font-weight: 700;
    }

    .top-right {
      pointer-events: auto;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .back-btn {
      padding: 10px 32px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      background: radial-gradient(circle at top left, rgba(248,250,252,0.12), rgba(15,23,42,0.98));
      color: #e5e7eb;
      text-decoration: none;
      font-family: var(--font-cond);
      font-size: 13px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      font-weight: 600;
      box-shadow: 0 10px 35px rgba(15,23,42,0.8);
      transition: all 0.25s ease-out;
    }
    .back-btn:hover {
      border-color: #f97316;
      background: radial-gradient(circle at top left, rgba(249,115,22,0.55), rgba(15,23,42,0.98));
      transform: translateY(-1px);
      box-shadow: 0 16px 45px rgba(249,115,22,0.45);
    }

    /* 图表容器 */
    #chart {
      position: absolute;
      inset: 72px 0 0 0;
    }

    /* 文案层 */
    .panel-layer {
      position: absolute;
      inset: 72px 0 0 0;
      pointer-events: none;
      z-index: 15;
    }

    .glass-card {
      position: absolute;
      max-width: 360px;
      padding: 22px 24px 20px;
      border-radius: 26px;
      background: radial-gradient(circle at top left, rgba(30,64,175,0.65), rgba(15,23,42,0.92));
      border: 1px solid var(--glass-border);
      box-shadow: var(--glass-shadow);
      backdrop-filter: blur(22px);
      -webkit-backdrop-filter: blur(22px);
      pointer-events: auto;
      color: var(--text-main);
      font-size: 13px;
      line-height: 1.7;
    }

    .glass-card h2 {
      font-family: var(--font-cond);
      font-size: 24px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    .glass-card small {
      display: block;
      font-family: var(--font-cond);
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #9ca3af;
      margin-bottom: 6px;
    }

    .glass-card p {
      color: var(--text-muted);
    }

    .card-overview {
      left: 48px;
      top: 116px;
    }

    .card-detail {
      right: 48px;
      bottom: 42px;
      max-width: 320px;
    }

    .metric-row {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-family: var(--font-mono);
      font-size: 12px;
      color: #cbd5f5;
    }

    .metric-row span.label {
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-family: var(--font-cond);
      font-size: 11px;
      color: #9ca3af;
    }

    .metric-row span.value {
      font-size: 14px;
    }

    .dot-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      font-size: 11px;
      margin-top: 10px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-family: var(--font-cond);
      color: #e5e7eb;
    }
    .dot-badge::before {
      content: "";
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--c-solar);
      box-shadow: 0 0 12px rgba(34,197,94,0.8);
    }

    /* 右下信息卡内部样式 */
    .detail-title {
      font-family: var(--font-cond);
      font-size: 20px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      margin: 4px 0 4px;
    }

    .detail-sub {
      font-size: 12px;
      color: #9ca3af;
      margin-bottom: 10px;
    }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .tag {
      padding: 2px 7px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(148,163,184,0.6);
      font-size: 10px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #cbd5f5;
      font-family: var(--font-cond);
    }

    @media (max-width: 900px) {
      .top-bar { padding: 12px 18px; }
      #chart { inset: 72px 0 0 0; }
      .card-overview {
        left: 18px;
        right: 18px;
        top: 90px;
        max-width: none;
      }
      .card-detail {
        right: 18px;
        left: 18px;
        bottom: 20px;
        max-width: none;
      }
    }
  </style>
</head>
<body>
  <!-- 顶部导航 -->
  <header class="top-bar">
    <div class="top-left">
      <div class="top-path">STARTIMES / UGANDA / ECOLOGY / SOLAR</div>
      <div class="top-title">SOLAR · OFF-GRID POWER</div>
    </div>
    <div class="top-right">
      <a class="back-btn" href="../index.html">BACK TO ECOLOGY</a>
    </div>
  </header>

  <!-- ECharts 容器 -->
  <div id="chart"></div>

  <!-- 文案层：毛玻璃卡片 -->
  <div class="panel-layer">
    <section class="glass-card card-overview">
      <small>SOLAR CLUSTER</small>
      <h2>ST·Solar 家族</h2>
      <p>
        这一页把乌干达四达的离网太阳能产品，看作围绕一颗“电力恒星”的三条轨道：
        <strong>S50</strong> 家族负责入门市场，
        <strong>S130</strong> 家族覆盖主力 100–150W 级别，
        <strong>S350</strong> 家族则面向高功率、大户型与小商用场景。
        轨道越外，代表系统功率与价格越高。
      </p>
      <p style="margin-top:8px;">
        每一颗绿色星点是一款具体机型；鼠标悬停可以看到它的功率段、典型应用与在整个 Solar 收入中的角色。
      </p>
      <div class="metric-row">
        <span class="label">Solar 占比</span>
        <span class="value">≈ 30% of Revenue</span>
      </div>
      <div class="metric-row">
        <span class="label">Main use</span>
        <span class="value">Rural HH · Shops · Schools</span>
      </div>
      <div class="dot-badge">Solar Product Orbits</div>
    </section>

    <section class="glass-card card-detail" id="detail-card">
      <small id="d-family-label">PRODUCT DETAIL</small>
      <div class="detail-title" id="d-name">Hover a Star</div>
      <div class="detail-sub" id="d-family">S50 Family · Entry Kit</div>
      <p id="d-desc">
        把鼠标移动到任意绿色星点上，这里会显示该机型的核心定位、典型功率段以及与 DVB / OTT 的协同关系。
      </p>

      <div class="metric-row">
        <span class="label">Watt Range</span>
        <span class="value" id="d-watt">–</span>
      </div>
      <div class="metric-row">
        <span class="label">Typical use</span>
        <span class="value" id="d-scenario">–</span>
      </div>

      <div class="tag-row" id="d-tags">
        <span class="tag">Solar</span>
      </div>
    </section>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script>
    // ================= 数据建模 =================

    // 三条轨道：内层 S50，中层 S130，外层 S350
    const orbits = [
      { id: 'S50',  name: 'S50 Family',  radius: 40, color: 'rgba(34,197,94,0.5)'  },
      { id: 'S130', name: 'S130 Family', radius: 60, color: 'rgba(129,140,248,0.55)' },
      { id: 'S350', name: 'S350 Family', radius: 80, color: 'rgba(56,189,248,0.55)' }
    ];

    // 具体机型（根据你上传的手册大致拆分；可后续再精细调整参数）
    const products = [
      // S50 家族（入门）
      { id: 'S50',  name: 'S50',  family: 'S50',  watt: '50 W',      scenario: 'Lantern · 小电灯',               tags: ['Entry Kit','Lantern'] },
      { id: 'S50A', name: 'S50A', family: 'S50',  watt: '50–80 W',   scenario: '基础照明 + 手机充电',             tags: ['Rural HH','Phone charging'] },
      { id: 'S50B', name: 'S50B', family: 'S50',  watt: '80–100 W',  scenario: '2–3 灯 + 小型电视',              tags: ['Starter TV','PayGo Ready'] },
      { id: 'S50C', name: 'S50C', family: 'S50',  watt: '100–120 W', scenario: '多灯 + 小电视 + 收音机',          tags: ['Multi-room','Upgrade path'] },

      // S130 家族（主力段）
      { id: 'S130',  name: 'S130',  family: 'S130', watt: '130 W',      scenario: '4–6 灯 + 24" TV + 机顶盒',   tags: ['Mainstream HH','DVB Ready'] },
      { id: 'S130A', name: 'S130A', family: 'S130', watt: '130–150 W', scenario: '家庭电视 + 解码器 + 充电',     tags: ['Rural TV','Bundle with DTT'] },
      { id: 'S130B', name: 'S130B', family: 'S130', watt: '150–180 W', scenario: '多房间照明 + TV + 小冰箱',      tags: ['Higher ARPU','Upsell'] },

      // S350 家族（高功率）
      { id: 'S350',  name: 'S350',  family: 'S350', watt: '300–350 W', scenario: 'Large HH · 小商铺',             tags: ['High Power','Shops & Bars'] },
      { id: 'S350A', name: 'S350A', family: 'S350', watt: '350–400 W', scenario: '冷饮店 · 小诊所 · 学校办公室',    tags: ['Micro-business','Clinic'] },
      { id: 'S350B', name: 'S350B', family: 'S350', watt: '400–500 W', scenario: '多终端 + 长时间用电',            tags: ['Premium','Mini-hub'] }
    ];

    // 把产品映射到极坐标 (半径 = 所属轨道半径；角度沿轨道均匀排布)
    const productPoints = [];
    const orbitAngleSpan = { S50: 110, S130: 120, S350: 130 }; // 每条轨道占用角度
    const orbitAngleStart = { S50: 210, S130: 220, S350: 230 }; // 每条轨道起始角度（整体略靠左上）

    const familyGroups = products.reduce((acc,p)=>{
      if(!acc[p.family]) acc[p.family] = [];
      acc[p.family].push(p);
      return acc;
    },{});

    Object.keys(familyGroups).forEach(famId => {
      const group = familyGroups[famId];
      const orbit = orbits.find(o => o.id === famId);
      const span = orbitAngleSpan[famId] || 120;
      const start = orbitAngleStart[famId] || 210;
      const step = span / (group.length + 1);

      group.forEach((p,idx)=>{
        const angle = start + step * (idx + 1); // deg
        const r = orbit.radius;
        productPoints.push({
          name: p.name,
          value: [r, angle],
          dataRef: p,
          orbitRef: orbit,
          symbolSize: 14,
          itemStyle: {
            color: 'rgba(34,197,94,0.98)',
            borderColor: 'rgba(250,250,250,0.9)',
            borderWidth: 2,
            shadowBlur: 16,
            shadowColor: 'rgba(34,197,94,0.95)'
          }
        });
      });
    });

    // ================= 图表初始化 =================
    const chart = echarts.init(document.getElementById('chart'));

    const option = {
      backgroundColor: 'transparent',
      animation: true,
      animationDuration: 1200,
      animationEasing: 'cubicOut',

      polar: {
        center: ['50%', '58%'],
        radius: '78%'
      },
      angleAxis: {
        type: 'value',
        min: 0,
        max: 360,
        startAngle: 90,
        clockwise: false,
        show: false
      },
      radiusAxis: {
        type: 'value',
        min: 0,
        max: 100,
        show: false
      },
      tooltip: { show: false },

      series: [
        // 背景星空小点
        {
          type: 'custom',
          coordinateSystem: 'none',
          renderItem: function (params, api) {
            const w = api.getWidth(), h = api.getHeight();
            const stars = [];
            for (let i = 0; i < 120; i++) {
              stars.push({
                type: 'circle',
                shape: {
                  cx: Math.random() * w,
                  cy: Math.random() * h,
                  r: Math.random() * 1.2 + 0.5
                },
                style: {
                  fill: 'rgba(248,250,252,' + (0.15 + Math.random() * 0.35) + ')'
                }
              });
            }
            return { type: 'group', children: stars };
          },
          data: [0],
          silent: true,
          z: 0
        },

        // 同心轨道
        {
          type: 'custom',
          coordinateSystem: 'none',
          renderItem: function (params, api) {
            const cx = api.getWidth() / 2;
            const cy = api.getHeight() * 0.58;
            const baseR = Math.min(api.getWidth(), api.getHeight()) * 0.28;
            const group = [];

            [0.9, 1.15, 1.4].forEach((k, idx) => {
              group.push({
                type: 'circle',
                shape: { cx, cy, r: baseR * k },
                style: {
                  stroke: 'rgba(148,163,184,' + (0.18 + idx * 0.06) + ')',
                  lineWidth: 1,
                  fill: 'none'
                }
              });
            });

            return { type: 'group', children: group };
          },
          data: [0],
          silent: true,
          z: 1
        },

        // 中央恒星光晕（无悬停）
        {
          type: 'custom',
          coordinateSystem: 'none',
          renderItem: function (params, api) {
            const cx = api.getWidth() / 2;
            const cy = api.getHeight() * 0.58;
            const r = Math.min(api.getWidth(), api.getHeight()) * 0.13;

            return {
              type: 'group',
              children: [
                {
                  // 外层柔光
                  type: 'circle',
                  shape: { cx, cy, r: r * 2.1 },
                  style: {
                    fill: 'radial-gradient(0.5 0.3, 0.5 0.5, 0.1 0.9, #ffffff00, #ffffff11, #ffffff00)',
                    shadowBlur: 80,
                    shadowColor: 'rgba(248,250,252,0.8)',
                    opacity: 0.8
                  }
                },
                {
                  // 主恒星
                  type: 'circle',
                  shape: { cx, cy, r: r },
                  style: {
                    fill: 'radial-gradient(0.3 0.2, 0.7 0.8, #ffffff, #e5f9ff, #bae6fd)',
                    shadowBlur: 40,
                    shadowColor: 'rgba(248,250,252,0.95)'
                  }
                }
              ]
            };
          },
          data: [0],
          silent: true,
          z: 2
        },

        // 扇形光带（轨道的极光感）
        {
          type: 'custom',
          coordinateSystem: 'none',
          renderItem: function (params, api) {
            const cx = api.getWidth() / 2;
            const cy = api.getHeight() * 0.58;
            const maxR = Math.min(api.getWidth(), api.getHeight()) * 0.42;
            const innerR = Math.min(api.getWidth(), api.getHeight()) * 0.16;

            const sectors = [];

            const defs = [
              { start: 210, end: 320, colorFrom: '#22c55e', colorTo: '#4ade80' },   // S50
              { start: 220, end: 340, colorFrom: '#a855f7', colorTo: '#c4b5fd' },   // S130
              { start: 230, end: 360, colorFrom: '#38bdf8', colorTo: '#7dd3fc' }    // S350
            ];

            defs.forEach((d, idx) => {
              const s = (d.start - 90) * Math.PI / 180;
              const e = (d.end   - 90) * Math.PI / 180;

              sectors.push({
                type: 'sector',
                shape: { cx, cy, r0: innerR * (1.05 + idx * 0.12), r: maxR * (0.85 + idx * 0.02), startAngle: s, endAngle: e },
                style: {
                  fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                    { offset: 0,   color: d.colorFrom + 'ee' },
                    { offset: 0.4, color: d.colorTo   + 'aa' },
                    { offset: 1,   color: d.colorTo   + '00' }
                  ]),
                  opacity: 0.9
                }
              });
            });

            return { type: 'group', children: sectors };
          },
          data: [0],
          silent: true,
          z: 2
        },

        // 轨道标签（S50 / S130 / S350）
        {
          type: 'custom',
          coordinateSystem: 'polar',
          renderItem: function (params, api) {
            const children = [];
            orbits.forEach((o, idx) => {
              const angleDeg = 190;
              const point = api.coord([o.radius + 3, angleDeg]);
              children.push({
                type: 'text',
                style: {
                  x: point[0],
                  y: point[1],
                  text: o.name.toUpperCase(),
                  fill: 'rgba(209,213,219,0.9)',
                  fontFamily: 'Barlow Condensed',
                  fontWeight: 600,
                  fontSize: 12,
                  textAlign: 'center',
                  textBaseline: 'middle',
                  opacity: 0.9
                }
              });
            });
            return { type: 'group', children };
          },
          data: [0],
          silent: true,
          z: 3
        },

        // 产品星点
        {
          type: 'effectScatter',
          name: 'Solar Products',
          coordinateSystem: 'polar',
          data: productPoints,
          symbol: 'circle',
          rippleEffect: {
            period: 6,
            scale: 2,
            brushType: 'stroke'
          },
          emphasis: {
            scale: 1.1
          },
          z: 5
        }
      ]
    };

    chart.setOption(option);

    // ================== 悬停交互：更新右下毛玻璃卡 ==================
    const card = document.getElementById('detail-card');
    const elName = document.getElementById('d-name');
    const elFamily = document.getElementById('d-family');
    const elDesc = document.getElementById('d-desc');
    const elWatt = document.getElementById('d-watt');
    const elScenario = document.getElementById('d-scenario');
    const elTags = document.getElementById('d-tags');
    const elFamLabel = document.getElementById('d-family-label');

    function updateDetail(data) {
      if (!data) return;
      const p = data.dataRef;
      const orbit = data.orbitRef;

      elFamLabel.textContent = orbit.name.toUpperCase();
      elName.textContent = p.name;
      elFamily.textContent = orbit.name + ' · ' + (p.scenario || '');
      elDesc.textContent =
        '典型功率段约为 ' + p.watt +
        '，主要场景：' + p.scenario +
        '。在整个 Solar 收入中，这类机型一般用于 ' +
        (orbit.id === 'S50'
          ? '入门与试水用户，帮助完成从燃油灯向电力的第一次迁移。'
          : orbit.id === 'S130'
            ? '主力家庭与小型商户，是 DVB / OTT 电视业务的天然搭档。'
            : '高价值长约用户，为微型商铺、小诊所与学校等提供稳定电力。');

      elWatt.textContent = p.watt;
      elScenario.textContent = p.scenario;

      // tags
      elTags.innerHTML = '';
      (p.tags || []).forEach(t => {
        const span = document.createElement('span');
        span.className = 'tag';
        span.textContent = t;
        elTags.appendChild(span);
      });
      const baseTag = document.createElement('span');
      baseTag.className = 'tag';
      baseTag.textContent = 'Solar';
      elTags.appendChild(baseTag);
    }

    chart.on('mouseover', function (params) {
      if (params.seriesType === 'effectScatter' && params.data && params.data.dataRef) {
        updateDetail(params.data);
      }
    });

    window.addEventListener('resize', () => chart.resize());
  </script>
</body>
</html>
