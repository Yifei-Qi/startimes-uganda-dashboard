<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Ecology · Business Constellation · StarTimes Uganda</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont,"SF Pro Text",
        "Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans SC",sans-serif;
      background: #050816;
      color: #e5e7eb;
      overflow: hidden;
    }

    .top-bar {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: 52px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 26px;
      z-index: 20;
      backdrop-filter: blur(18px);
      background: linear-gradient(
        to bottom,
        rgba(5,7,24,0.96),
        rgba(5,7,24,0.75),
        transparent
      );
      border-bottom: 1px solid rgba(148,163,184,0.35);
    }

    .brand {
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .brand-path {
      font-size: 11px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: #6b7280;
    }

    .brand-title {
      font-size: 16px;
      font-weight: 600;
    }

    .top-actions {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 11px;
    }

    .chip {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.6);
      background: rgba(15,23,42,0.8);
      color: #9ca3af;
    }

    .back {
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      background: radial-gradient(circle at top left,rgba(96,165,250,0.9),rgba(15,23,42,0.98));
      color: #e5e7eb;
      text-decoration: none;
    }

    .scene {
      position: absolute;
      top: 52px; bottom: 0; left: 0; right: 0;
      overflow: hidden;
      background:
        radial-gradient(circle at 15% 10%, rgba(56,189,248,0.24), transparent 55%),
        radial-gradient(circle at 80% 90%, rgba(234,179,8,0.28), transparent 60%),
        radial-gradient(circle at 70% 10%, rgba(244,63,94,0.18), transparent 55%),
        #020617;
    }

    #eco-orbit {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
    }

    /* 信息卡片 */
    .panel {
      position: absolute;
      border-radius: 20px;
      padding: 14px 16px;
      border: 1px solid rgba(148,163,184,0.55);
      background: radial-gradient(circle at top left, rgba(15,23,42,0.95), rgba(15,23,42,0.9));
      box-shadow:
        0 18px 55px rgba(15,23,42,0.9),
        0 0 0 1px rgba(15,23,42,0.9) inset;
      backdrop-filter: blur(18px);
      max-width: 260px;
      font-size: 12px;
      line-height: 1.6;
      color: #9ca3af;
    }

    .panel h2 {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
      color: #e5e7eb;
    }

    .panel small {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #64748b;
    }

    .panel-main {
      left: 42px;
      top: 82px;
    }

    .panel-legacy {
      bottom: 42px;
      left: 40px;
      max-width: 230px;
    }

    .panel-new {
      bottom: 46px;
      right: 44px;
      max-width: 230px;
    }

    .panel-kpi {
      top: 80px;
      right: 40px;
      max-width: 230px;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }

    .pill {
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.55);
      font-size: 11px;
      color: #cbd5f5;
    }

    @media (max-width: 900px) {
      .panel-main {
        left: 16px;
        top: 76px;
        right: 16px;
        max-width: none;
      }
      .panel-legacy,
      .panel-new,
      .panel-kpi {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <div class="brand">
      <div class="brand-path">STARTIMES UGANDA · DATA SPACE</div>
      <div class="brand-title">Ecology · 业务星团图 Business Constellation</div>
    </div>
    <div class="top-actions">
      <div class="chip">每个业务 = 一颗行星 · KPI = 周围星团</div>
      <a class="back" href="../index.html">Back to Universe</a>
    </div>
  </div>

  <div class="scene">
    <div id="eco-orbit"></div>

    <aside class="panel panel-main">
      <small>OVERVIEW</small>
      <h2>五条业务线的 KPI 星团</h2>
      <p>
        本图把五条核心业务线视作五颗行星：
        <strong>Solar</strong>、<strong>DTV</strong>、<strong>DTH</strong>、
        <strong>DTT</strong>、<strong>OTT</strong>。
        行星周围的小点代表该业务下的关键指标（销量、收入、ARPPU 等）。
        点越大代表数值越高，绿色表示环比/同比上升，红色表示下降，灰色则相对稳定。
      </p>
      <div class="pill-row">
        <span class="pill">Solar · 线下太阳能</span>
        <span class="pill">DTV / DTH / DTT · 传统 DVB</span>
        <span class="pill">OTT · 互联网视频</span>
      </div>
    </aside>

    <aside class="panel panel-legacy">
      <small>LEGACY DVB CLUSTER</small>
      <h2>DTV · DTH · DTT 电视业务星团</h2>
      <p>
        这三个星团代表传统付费电视业务：新增用户、在线用户、扣费金额、
        充值金额、ARPPU 等指标整体呈下行趋势，点云颜色偏暖红。
        通过点的密度与大小，可以快速比较不同业务线的体量与衰减速度。
      </p>
    </aside>

    <aside class="panel panel-new">
      <small>SOLAR &amp; OTT CLUSTER</small>
      <h2>Solar 与 OTT 的新增长空间</h2>
      <p>
        Solar 星团体现离网增量市场，销量与分期款相关指标围绕其轨道分布；
        OTT 星团则聚焦新增用户、DAU/MAU、会员充值与 DSP 广告收入等，
        点云中更多绿色高亮点暗示其增长潜力与创新空间。
      </p>
    </aside>

    <aside class="panel panel-kpi">
      <small>HOW TO READ</small>
      <h2>点的含义</h2>
      <p>
        位置：靠近某颗行星的点属于该业务线；<br/>
        大小：当前 KPI 数值在本业务内部的相对大小；<br/>
        颜色：绿色 = 上升，红色 = 下降，灰色 = 稳定。
        鼠标悬停可以查看具体指标名称与数值。
      </p>
    </aside>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script>
    var dom = document.getElementById('eco-orbit');
    var chart = echarts.init(dom);

    // 基本业务配置：角度、半径层级
    var businessDefs = [
      { id: 'Solar', label: 'Solar', angle: -120, radius: 0.32, tone: 'green' },
      { id: 'DTV',  label: 'DTV',  angle: -40,  radius: 0.46, tone: 'blue'  },
      { id: 'DTH',  label: 'DTH',  angle: 40,   radius: 0.60, tone: 'cyan'  },
      { id: 'DTT',  label: 'DTT',  angle: 120,  radius: 0.74, tone: 'indigo'},
      { id: 'OTT',  label: 'OTT',  angle: 200,  radius: 0.88, tone: 'violet'}
    ];

    // 不同色系的基础色（简化版本）
    function toneColor(tone, alpha) {
      switch (tone) {
        case 'green':  return 'rgba(34,197,94,'  + alpha + ')';
        case 'blue':   return 'rgba(59,130,246,' + alpha + ')';
        case 'cyan':   return 'rgba(45,212,191,' + alpha + ')';
        case 'indigo': return 'rgba(129,140,248,'+ alpha + ')';
        case 'violet': return 'rgba(236,72,153,' + alpha + ')';
        default:       return 'rgba(148,163,184,'+ alpha + ')';
      }
    }

    // 业务 KPI 粗略数据（根据你截图录入，数值只是示意）
    var kpiRaw = {
      Solar: [
        { name: '销量 每月累计',          value: 1481,    trend: 'down' },
        { name: '销售收入(应收) 每月累计', value: 168973,  trend: 'down' },
        { name: '全款收款 每月累计',      value: 1148,    trend: 'down' },
        { name: '首付款收款 每月累计',    value: 10171,   trend: 'down' },
        { name: '分期款收款 每月累计',    value: 80729,   trend: 'down' },
        { name: '累计应收分期款',         value: 23072112,trend: 'up'   },
        { name: '当月应收分期款',         value: 224472,  trend: 'down' },
        { name: '分期中用户数',           value: 234390,  trend: 'up'   }
      ],
      DTV: [
        { name: '新增用户数 每月累计',    value: 110,   trend: 'down' },
        { name: '在线用户数 每月去重',    value: 8112, trend: 'down' },
        { name: '注册用户数 月末最后一天',value: 39510,trend: 'down' },
        { name: '扣费金额 每月累计',      value: 4353, trend: 'down' },
        { name: '充值金额 每月累计',      value: 6408, trend: 'down' },
        { name: '扣费用户数 每月去重',    value: 7501, trend: 'down' },
        { name: '充值用户数 每月去重',    value: 1949, trend: 'down' },
        { name: '月扣费ARPPU',           value: 0.58, trend: 'down' },
        { name: '月充值ARPPU',           value: 3.288,trend: 'down' },
        { name: '销量 每月累计',          value: 50,   trend: 'down' }
      ],
      DTH: [
        { name: '新增用户数 每月累计',    value: 425,    trend: 'down' },
        { name: '在线用户数 每月去重',    value: 349860, trend: 'down' },
        { name: '注册用户数 月末最后一天',value: 1101568,trend: 'down' },
        { name: '扣费金额 每月累计',      value: 190787, trend: 'down' },
        { name: '充值金额 每月累计',      value: 289402, trend: 'down' },
        { name: '扣费用户数 每月去重',    value: 339611, trend: 'down' },
        { name: '充值用户数 每月去重',    value: 85237,  trend: 'down' },
        { name: '月扣费ARPPU',           value: 0.562,  trend: 'down' },
        { name: '月充值ARPPU',           value: 3.395,  trend: 'down' }
      ],
      DTT: [
        { name: '新增用户数 每月累计',    value: 249,    trend: 'down' },
        { name: '在线用户数 每月去重',    value: 344459, trend: 'down' },
        { name: '注册用户数 月末最后一天',value: 1848112,trend: 'down' },
        { name: '扣费金额 每月累计',      value: 180694, trend: 'down' },
        { name: '充值金额 每月累计',      value: 263016, trend: 'down' },
        { name: '扣费用户数 每月去重',    value: 340802, trend: 'down' },
        { name: '充值用户数 每月去重',    value: 112640, trend: 'down' },
        { name: '月扣费ARPPU',           value: 0.53,   trend: 'down' },
        { name: '月充值ARPPU',           value: 2.335,  trend: 'down' }
      ],
      OTT: [
        { name: '新增用户 本月累计',       value: 13426,  trend: 'up'  },
        { name: 'App日活 本月日均',       value: 46168,  trend: 'up'  },
        { name: 'App月活 本月日均',       value: 371110, trend: 'up'  },
        { name: '会员充值金额 本月累计',   value: 2365.15,trend: 'up'  },
        { name: 'DVB充值金额 本月累计',    value: 1782.63,trend: 'up'  },
        { name: '绑卡续费率 本月日均',     value: 31.74,  trend: 'up'  },
        { name: 'DSP广告收入 本月累计',   value: 9.78,   trend: 'up'  }
      ]
    };

    // 生成星团点数据
    var clusterPoints = [];
    var planetCores = [];

    businessDefs.forEach(function (bizDef) {
      var metrics = kpiRaw[bizDef.id] || [];
      if (!metrics.length) return;

      var maxVal = metrics.reduce(function (m, x) {
        return Math.max(m, x.value);
      }, 0.0001);

      // 行星核心
      planetCores.push({
        value: 1,
        bizId: bizDef.id,
        label: bizDef.label,
        angleDeg: bizDef.angle,
        radiusNorm: bizDef.radius,
        color: toneColor(bizDef.tone, 0.95)
      });

      metrics.forEach(function (m) {
        // 每个 KPI 拆成多个点，增加“体量感”
        var copies = 2 + Math.round((m.value / maxVal) * 4); // 2-6 个
        var valueRatio = m.value / maxVal;

        for (var i = 0; i < copies; i++) {
          var angleJitter = (Math.random() - 0.5) * 26;  // +/- 13°
          var radiusJitter = (Math.random() - 0.5) * 0.08; // 环厚

          var angle = bizDef.angle + angleJitter;
          var radius = bizDef.radius + radiusJitter;

          var baseSize = 2.5 + 6 * Math.sqrt(valueRatio);
          var size = baseSize * (0.7 + Math.random() * 0.6);

          var trend = m.trend || 'flat';
          var alpha = 0.42 + Math.random() * 0.45;
          var color;
          if (trend === 'up') {
            color = 'rgba(74,222,128,' + alpha + ')';
          } else if (trend === 'down') {
            color = 'rgba(248,113,113,' + alpha + ')';
          } else {
            color = toneColor(bizDef.tone, alpha);
          }

          clusterPoints.push({
            value: size,          // 用作点半径
            bizId: bizDef.id,
            bizLabel: bizDef.label,
            metric: m.name,
            rawValue: m.value,
            trend: trend,
            angleDeg: angle,
            radiusNorm: radius,
            color: color
          });
        }
      });
    });

    var option = {
      backgroundColor: 'transparent',
      tooltip: {
        trigger: 'item',
        formatter: function (params) {
          var d = params.data || {};
          if (!d.metric) return '';
          var trendText =
            d.trend === 'up' ? '趋势：上升'
              : d.trend === 'down' ? '趋势：下降'
              : '趋势：相对平稳';
          return [
            d.bizLabel + ' · ' + d.metric,
            '当前值：' + d.rawValue,
            trendText
          ].join('<br/>');
        }
      },
      series: [
        // 背景同心圆 + 中心恒星
        {
          type: 'custom',
          name: 'rings',
          silent: true,
          renderItem: function (params, api) {
            var cx = api.getWidth() / 2;
            var cy = api.getHeight() * 0.62;
            var maxR = Math.min(api.getWidth(), api.getHeight()) * 0.46;
            var levels = 8;
            var children = [];

            for (var i = 1; i <= levels; i++) {
              children.push({
                type: 'circle',
                shape: { cx: cx, cy: cy, r: (maxR / levels) * i },
                style: {
                  stroke: 'rgba(15,23,42,' + (0.25 + i * 0.06) + ')',
                  fill: 'transparent',
                  lineWidth: 0.7
                }
              });
            }

            // 中心基座
            children.push({
              type: 'circle',
              shape: { cx: cx, cy: cy, r: maxR * 0.16 },
              style: {
                fill: 'rgba(15,23,42,0.98)',
                shadowBlur: 36,
                shadowColor: 'rgba(0,0,0,0.98)'
              }
            });

            // 中心光点
            children.push({
              type: 'circle',
              shape: { cx: cx, cy: cy, r: maxR * 0.035 },
              style: {
                fill: 'rgba(248,250,252,0.96)',
                shadowBlur: 40,
                shadowColor: 'rgba(248,250,252,0.95)'
              }
            });

            return { type: 'group', children: children };
          },
          data: [0],
          z: 0
        },

        // KPI 星团点
        {
          type: 'custom',
          name: 'business-clusters',
          renderItem: function (params, api) {
            var size = api.value(0);
            var d = params.data;

            var cx = api.getWidth() / 2;
            var cy = api.getHeight() * 0.62;
            var maxR = Math.min(api.getWidth(), api.getHeight()) * 0.46;

            var r = d.radiusNorm * maxR;
            var rad = d.angleDeg * Math.PI / 180;
            var x = cx + Math.cos(rad) * r;
            var y = cy + Math.sin(rad) * r;

            return {
              type: 'circle',
              shape: { cx: x, cy: y, r: size },
              style: {
                fill: d.color,
                stroke: 'rgba(15,23,42,0.9)',
                lineWidth: 0.4,
                shadowBlur: 14,
                shadowColor: d.color
              }
            };
          },
          data: clusterPoints,
          z: 2
        },

        // 行星核心 + 文本标签
        {
          type: 'custom',
          name: 'planets',
          tooltip: { show: false },
          renderItem: function (params, api) {
            var d = params.data;
            var cx = api.getWidth() / 2;
            var cy = api.getHeight() * 0.62;
            var maxR = Math.min(api.getWidth(), api.getHeight()) * 0.46;

            var r = d.radiusNorm * maxR;
            var rad = d.angleDeg * Math.PI / 180;
            var x = cx + Math.cos(rad) * r;
            var y = cy + Math.sin(rad) * r;

            return {
              type: 'group',
              children: [
                {
                  type: 'circle',
                  shape: { cx: x, cy: y, r: 10 },
                  style: {
                    fill: d.color,
                    shadowBlur: 24,
                    shadowColor: d.color
                  }
                },
                {
                  type: 'text',
                  style: {
                    x: x + 14,
                    y: y + 3,
                    text: d.label,
                    fill: '#e5e7eb',
                    fontSize: 11,
                    fontFamily: '-apple-system,BlinkMacSystemFont,"SF Pro Text",sans-serif'
                  }
                }
              ]
            };
          },
          data: planetCores,
          z: 3
        }
      ]
    };

    chart.setOption(option);
    window.addEventListener('resize', function () {
      chart.resize();
    });
  </script>
</body>
</html>
